angular.module("ualib.softwareList.templates",["software-list/software-list.tpl.html"]),angular.module("software-list/software-list.tpl.html",[]).run(["$templateCache",function(a){a.put("software-list/software-list.tpl.html",'<div class="jumbotron-header">\n    <div class="jumbotron">\n        <div class="container">\n            <div class="row">\n                <div class="col-md-12">\n                    <ol class="breadcrumb" typeof="BreadcrumbList" vocab="http://schema.org/">\n                        <li><a title="Go to The University of Alabama Libraries." href="/#/home" class="home">The University of Alabama Libraries</a></li>\n                        <li><a title="Go to SoftwareList." href="/#/software" class="post post-page">Software List</a></li>\n                    </ol>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-12">\n                    <h1>Libraries\' Software List</h1>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="container">\n    <div class="row">\n        <div class="col-md-3 col-md-push-9">\n            <form class="software-list-facets">\n                <div class="form-group">\n                <span class="page-header">\n                    <h2 class="h4">Filter Software List By</h2>\n                </span>\n                </div>\n                <div class="form-group">\n\n                    <input type="text" class="form-control" ng-model="soft.search" placeholder="Search software, locations, etc..." aria-label="Search our software list">\n\n                </div>\n                <div class="form-group">\n                    <div class="btn-group btn-group-justified">\n                        <button class="btn btn-default active" ng-model="soft.os" btn-radio="\'\'" uncheckable>All</button>\n                        <button class="btn btn-default" ng-model="soft.os" btn-radio="\'1\'" uncheckable><span class="fa fa-fw fa-windows"></span><span class="sr-only">Windows</span></button>\n                        <button class="btn btn-default" ng-model="soft.os" btn-radio="\'2\'" uncheckable><span class="fa fa-fw fa-apple"></span><span class="sr-only">Mac</span></button>\n                    </div>\n                </div>\n                <div class="form-group hidden-xs">\n                    <h3 class="h5">Locations</h3>\n                    <div class="radio">\n                        <label>\n                            <input type="radio" value="" ng-model="soft.loc" checked>\n                            All Locations\n                        </label>\n                    </div>\n                    <div class="radio" ng-repeat="loc in locations">\n                        <label>\n                            <input type="radio" value="{{loc.name}}" ng-model="soft.loc">\n                            {{loc.name}}\n                        </label>\n                    </div>\n                </div>\n                <div class="form-group hidden-xs">\n                    <h3 class="h5">Categories</h3>\n                    <div class="radio">\n                        <label>\n                            <input type="radio" value="" ng-model="soft.cat">\n                            All categories\n                        </label>\n                    </div>\n                    <div class="radio" ng-repeat="cat in categories">\n                        <label>\n                            <input type="radio" value="{{cat.name}}" ng-model="soft.cat">\n                            {{cat.name}}\n                        </label>\n                    </div>\n                </div>\n                <div class="form-group hidden-xs">\n                    <button type="button" class="btn btn-block btn-primary" ng-click="resetFilters()"><span class="fa fa-fw fa-refresh"></span> Reset filters</button>\n                </div>\n            </form>\n        </div>\n        <div class="col-md-9 col-md-pull-3 software-list-container">\n            <span class="h4 text-right" ng-show="pager.totalItems > 0">\n                Showing {{pager.firstItem}}-{{pager.lastItem}} of {{pager.totalItems}} results\n            </span>\n\n            <div ng-if="(soft.cat || soft.os || soft.loc)">\n\n                <ol class="breadcrumb facetcrumb">\n                    <li ng-if="soft.os"><strong>OS:</strong> <button type="button" class="btn btn-default" ng-click="soft.os = \'\'">{{soft.os == 1 ? \'Windows\' : \'OS X\'}} <span class="text-muted" aria-hidden="true">&times;</span></button></li>\n                    <li ng-if="soft.loc"><strong>Location:</strong> <button type="button" class="btn btn-default" ng-click="soft.loc = \'\'">{{soft.loc}} <span class="text-muted" aria-hidden="true">&times;</span></button></li>\n                    <li ng-if="soft.cat"><strong>Category:</strong> <button type="button" class="btn btn-default" ng-click="soft.cat = \'\'">{{soft.cat}} <span class="text-muted" aria-hidden="true">&times;</span></button></li>\n\n                    <li class="pull-right"><button type="button" class="btn btn-primary btn-small reset-btn" title="Reset filters" ng-click="resetFilters()"><i class="fa fa-refresh"></i></button></li>\n                </ol>\n            </div>\n\n            <div class="media software-item animate-repeat" ng-repeat="item in filteredSoft | after:(pager.page-1)*pager.perPage | limitTo:20">\n                <div class="media-left">\n                    <img class="media-object" ng-src="{{item.icon}}" alt="{{item.title}}">\n                </div>\n                <div class="media-body">\n                    <h3 class="media-heading" ng-bind-html="item.title | highlight:soft.search">\n                    </h3>\n\n                    <div ng-bind-html="item.description | highlight:soft.search"></div>\n\n                    <div class="row">\n                        <div class="details-context col-md-6" ng-repeat="ver in item.versions | orderBy:os">\n                            <div class="h4 text-muted">\n                                <span class="fa fa-{{ver.osName}}"></span>\n                                Version {{ver.version}}\n                            </div>\n                        <span ng-repeat="loc in ver.locations | orderBy:\'name\'">\n                            <!--<span ng-if="loc.parent" ng-bind-html="(locations | filter:loc.parent)[0].name"></span>-->\n                            <span ng-bind-html="loc.name | highlight:soft.search | highlight:soft.loc:true"></span>\n                        </span>\n                        </div>\n                    </div>\n\n                    <div class="details hidden-xs">\n                        <div class="software-links">\n                            <ul class="list-inline nav-justified" style="margin-top: 5px;">\n                                <li ng-repeat="link in item.links" ng-if="item.links">\n                                    <a ng-href="{{link.url}}" target="{{link.title}}" class="external-link">{{link.title}}</a>\n                                </li>\n                                <li ng-if="item.modules">\n                                    <div collapse="!isCollapsed" ng-bind-html="item.modules | highlight:soft.search"></div>\n                                    <button class="btn btn-default btn-xs" ng-click="isCollapsed = !isCollapsed">\n                                        {{!isCollapsed ? "Show" : "Hide"}} Available Modules\n                                    </button>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="text-center">\n                <pagination class="pagination-sm" ng-model="pager.page" total-items="pager.totalItems" max-size="pager.maxSize" boundary-links="true" rotate="false" items-per-page="pager.perPage" ng-change="pageChange()" ng-if="pager.totalItems > pager.perPage"></pagination>\n            </div>\n\n            <div class="alert alert-warning text-center" role="alert" ng-show="pager.totalItems < 1">\n                <h2>\n                    No <span ng-if="soft.cat"><strong>{{soft.cat | lowercase}}</strong></span> software is available\n                    <span ng-if="soft.os">on <strong>{{soft.os == 1 ? \'Windows\' : \'OS X\'}}</strong> computers</span>\n                    <span ng-if="soft.loc">in <strong>{{soft.loc}}</strong></span>\n                    <span ng-if="soft.search">that matches the search "<strong>{{soft.search}}</strong>"</span>\n                </h2>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("ualib.softwareList",["ngRoute","ngResource","ngSanitize","ngAnimate","angular.filter","ui.bootstrap","duScroll","ualib.ui","ualib.softwareList.templates"]),angular.module("ualib.softwareList").factory("softwareFactory",["$resource",function(a){return a("//wwwdev2.lib.ua.edu/softwareList/api/:software",{software:"all"},{get:{method:"GET",cache:!0}})}]),angular.module("ualib.softwareList").config(["$routeProvider",function(a){a.when("/software",{reloadOnSearch:!1,resolve:{software:["$filter","softwareFactory",function(a,b){return b.get({software:"all"},function(a){for(var b=0,c=a.software.length;c>b;b++){for(var d=[],e=0,f=a.software[b].versions.length;f>e;e++)switch(d.push(a.software[b].versions[e].os),a.software[b].versions[e].os){case"3":a.software[b].versions[e].osName="linux";break;case"2":a.software[b].versions[e].osName="apple";break;default:a.software[b].versions[e].osName="windows"}a.software[b].os=d.join("")}return a},function(a,b,c,d){console.log("ERROR: software list"),console.log({data:a,status:b,headers:c,config:d})})}]},templateUrl:"software-list/software-list.tpl.html",controller:"SoftwareListCtrl"})}]).controller("SoftwareListCtrl",["$scope","software","$location","$filter","$document",function(a,b,c,d,e){function f(b){var c=b;c=d("filter")(c,{categories:a.soft.cat}),c=d("filter")(c,{versions:a.soft.loc}),c=d("filter")(c,a.soft.search),c=d("filterBy")(c,["os"],a.soft.os),a.filteredSoft=c,a.pager.totalItems=a.filteredSoft.length,a.pager.firstItem=(a.pager.page-1)*a.pager.perPage+1,a.pager.lastItem=a.pager.totalItems<a.pager.perPage?a.pager.totalItems:a.pager.page*a.pager.perPage;var e=Math.floor(a.pager.totalItems/a.pager.maxSize);e<a.pager.page&&(a.pager.page=e||1)}var g=[];a.soft={};var h={os:"",search:"",cat:"",loc:""};b.$promise.then(function(b){g=b.software,a.resetFilters(),a.categories=b.categories,a.locations=b.locations.filter(function(a){return 0===parseInt(a.parent)});var d=c.search();for(var e in d)a.pager.hasOwnProperty(e)&&(a.pager[e]=d[e]),a.soft.hasOwnProperty(e)&&(a.soft[e]=d[e]);a.$on("$locationChangeSuccess",function(){f(g)}),a.$on("$destroy",function(){i()}),f(g)});var i=a.$watch("soft",function(a,b){for(var d in a)""!==a[d]?c.search(d,a[d]):c.search(d,null)},!0);a.update=function(){var a={};angular.forEach(soft,function(b,c){angular.isDefined(b)&&""!==b&&(a[c]=b)}),c.search(a)},a.pageChange=function(){c.search("page",a.pager.page),e.duScrollTo(0,30,500,function(a){return--a*a*a+1})},a.resetFilters=function(){a.pager={page:1,perPage:20,maxSize:10,totalItems:0},angular.copy(h,a.soft)}}]);